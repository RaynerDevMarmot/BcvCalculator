<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AL CAMBIO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            dark: '#1A1A1A',
            'dark-light': '#2c2c2c',
            'green-accent': '#28B463',
            'gray-light': '#a0a0a0',
          },
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
          }
        }
      }
    }
  </script>
</head>
<body class="bg-dark text-white flex flex-col items-center min-h-screen p-4">

  <!-- Header -->
  <header class="w-full max-w-md flex items-center justify-between p-4 mb-6">
    <button id="menu-btn" class="text-white p-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    <h2 class="font-bold text-lg">AL CAMBIO</h2>
    <button id="share-btn" class="text-white p-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12v.01M12 4v.01M20 12v.01M12 20v.01M4.93 4.93l.01.01M19.07 4.93l.01.01M4.93 19.07l.01.01M19.07 19.07l.01.01" />
      </svg>
    </button>
  </header>

  <!-- Logo -->
  <div class="flex flex-col items-center mb-6">
    <div class="w-20 h-20 rounded-full border-4 border-green-accent flex items-center justify-center bg-gray-900 shadow-lg">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 8c-1.657 0-3 1.343-3 3h3v2H9c0 1.657 1.343 3 3 3v2m0-10V4m0 16v-2" />
      </svg>
    </div>
    <h2 class="mt-3 text-lg font-semibold text-gray-200">Conversor USD â†” VES</h2>
  </div>

  <!-- Conversor -->
  <div class="bg-dark-light p-6 rounded-2xl shadow-2xl w-full max-w-md flex flex-col space-y-4">
    <!-- USD -->
    <div>
      <label for="usd-input" class="text-gray-light font-medium text-left block mb-1">$ USD</label>
      <input type="number" id="usd-input" class="w-full text-2xl text-right bg-transparent border-b-2 border-gray-600 focus:border-green-accent p-2 rounded transition" placeholder="0">
    </div>

    <!-- VES -->
    <div>
      <label for="ves-input" class="text-gray-light font-medium text-left block mb-1">Bs VES</label>
      <input type="text" id="ves-input" class="w-full text-2xl text-right bg-transparent border-b-2 border-gray-600 focus:border-green-accent p-2 rounded transition" placeholder="0">
    </div>

    <!-- Botones -->
    <div class="flex justify-between mt-2 space-x-2">
      <button id="copy-btn" class="flex-1 px-4 py-2 bg-green-accent rounded-lg hover:bg-green-600 transition">ðŸ“‹ Copiar</button>
      <button id="clear-btn" class="flex-1 px-4 py-2 bg-red-500 rounded-lg hover:bg-red-600 transition">ðŸ§¹ Limpiar</button>
      <button id="refresh-btn" class="flex-1 px-4 py-2 bg-blue-500 rounded-lg hover:bg-blue-600 transition">ðŸ”„ Actualizar</button>
    </div>

    <!-- Tasa -->
    <div id="rate-display" class="text-center text-gray-light mt-4">
      Cargando tasa...
    </div>
  </div>

  <script>
    const usdInput = document.getElementById("usd-input");
    const vesInput = document.getElementById("ves-input");
    const rateDisplay = document.getElementById("rate-display");
    const refreshBtn = document.getElementById("refresh-btn");
    const copyBtn = document.getElementById("copy-btn");
    const clearBtn = document.getElementById("clear-btn");
    const shareBtn = document.getElementById("share-btn");

    let exchangeRate = null;
    let isUsdToVes = true;

    const fetchExchangeRate = async () => {
      rateDisplay.textContent = "Cargando tasa...";
      try {
        const response = await fetch("https://open.er-api.com/v6/latest/USD");
        const data = await response.json();
        exchangeRate = data.rates.VES;

        // Fecha de Ãºltima actualizaciÃ³n
        const lastUpdate = new Date(data.time_last_update_utc).toLocaleString("es-VE", {
          dateStyle: "short",
          timeStyle: "short"
        });

        rateDisplay.innerHTML = `
          <div class="text-gray-light text-sm">Ãšltima actualizaciÃ³n: ${lastUpdate}</div>
          <div class="text-white text-2xl font-bold mt-1">
            1 USD = ${exchangeRate.toLocaleString("es-VE",{minimumFractionDigits:2, maximumFractionDigits:2})} VES
          </div>
        `;
      } catch (e) {
        rateDisplay.textContent = "Error al obtener la tasa.";
        console.error(e);
      }
    };

    const convertToVes = (amount) => {
      if(exchangeRate) vesInput.value = (amount * exchangeRate).toLocaleString("es-VE",{minimumFractionDigits:2, maximumFractionDigits:2});
    };
    const convertToUsd = (amount) => {
      if(exchangeRate) usdInput.value = (amount / exchangeRate).toFixed(2);
    };

    usdInput.addEventListener("input", e => { if(isUsdToVes) convertToVes(parseFloat(e.target.value)||0); });
    vesInput.addEventListener("input", e => { 
      const val = parseFloat(e.target.value.replace(/\./g,"").replace(",","."));
      if(!isUsdToVes) convertToUsd(val||0);
    });

    usdInput.addEventListener("focus", ()=> { isUsdToVes=true; vesInput.setAttribute("readonly",true); usdInput.removeAttribute("readonly"); });
    vesInput.addEventListener("focus", ()=> { isUsdToVes=false; usdInput.setAttribute("readonly",true); vesInput.removeAttribute("readonly"); });

    refreshBtn.addEventListener("click", fetchExchangeRate);

    copyBtn.addEventListener("click", () => {
      const text = `USD: ${usdInput.value} â†’ VES: ${vesInput.value}`;
      navigator.clipboard.writeText(text).then(()=>alert("Copiado al portapapeles"));
    });

    clearBtn.addEventListener("click", () => { usdInput.value=""; vesInput.value=""; usdInput.focus(); });

    shareBtn.addEventListener("click", async () => {
      if(navigator.share){
        navigator.share({title:"Conversor AL CAMBIO", url:location.href});
      } else {
        alert("Comparte esta URL manualmente: " + location.href);
      }
    });

    window.addEventListener("load", fetchExchangeRate);
  </script>
</body>
</html>

